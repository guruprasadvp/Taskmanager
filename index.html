<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Task Manager</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 2rem; }
        .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #eee; padding-bottom: 1rem; }
        .header h1 { margin: 0; }
        .header a { text-decoration: none; background: #dc3545; color: white; padding: 0.5rem 1rem; border-radius: 4px; }
        .task-form { margin-top: 1.5rem; display: flex; }
        .task-form input { flex-grow: 1; padding: 0.7rem; border: 1px solid #ddd; }
        .task-form button { padding: 0.7rem 1rem; border: none; background: #007bff; color: white; cursor: pointer; }
        .task-list { list-style: none; padding: 0; margin-top: 2rem; }
        .task-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem; border: 1px solid #eee; background: #fff; margin-bottom: 0.5rem; }
        .task-item form { display: flex; align-items: center; gap: 0.5rem; }
        .task-item span { flex-grow: 1; }
        .task-item .delete-link { color: #dc3545; text-decoration: none; margin-left: 1rem; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Welcome, {{ current_user.username }}!</h1>
            <a href="{{ url_for('logout') }}">Logout</a>
        </div>

        <form action="{{ url_for('add_task') }}" method="POST" class="task-form">
            <input type="text" name="title" placeholder="Enter a new task..." required>
            <button type="submit">Add Task</button>
        </form>

        <ul class="task-list">
            {% for task in tasks %}
                <li class="task-item">
                    <span>{{ task.title }}</span>

                    <form action="{{ url_for('update_task', task_id=task.id) }}" method="POST">
                        <select name="status" onchange="this.form.submit()">
                            <option value="To Do" {% if task.status == 'To Do' %}selected{% endif %}>To Do</option>
                            <option value="In Progress" {% if task.status == 'In Progress' %}selected{% endif %}>In Progress</option>
                            <option value="Done" {% if task.status == 'Done' %}selected{% endif %}>Done</option>
                        </select>
                    </form>

                    <a href="{{ url_for('delete_task', task_id=task.id) }}" class="delete-link" 
                       onclick="return confirm('Are you sure you want to delete this task?');">
                       Delete
                    </a>
                </li>
            {% else %}
                <li>No tasks yet. Add one!</li>
            {% endfor %}
        </ul>
    </div>
</body>
</html>
